---
title: Out of stock detection using Azure and Azure Stack Edge
description: Lär dig hur du använder Azure och Azure Stack Edge för att implementera out-of-stock-identifiering.
author: BryanLa
ms.topic: article
ms.date: 05/24/2021
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 05/24/2021
ms.openlocfilehash: b25a6391c4e64fa7018031bac4fb7d098c56b529
ms.sourcegitcommit: cf2c4033d1b169f5b63980ce1865281366905e2e
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 05/25/2021
ms.locfileid: "110343883"
---
# <a name="out-of-stock-detection-at-the-edge-pattern"></a><span data-ttu-id="7444f-103">Identifiering av out-of-lager vid kantmönstret</span><span class="sxs-lookup"><span data-stu-id="7444f-103">Out of stock detection at the edge pattern</span></span>

<span data-ttu-id="7444f-104">Det här mönstret illustrerar hur du fastställer om hyllor har produkter utanför lager med hjälp av Azure Stack Edge eller Azure IoT Edge enhet och nätverkskameror.</span><span class="sxs-lookup"><span data-stu-id="7444f-104">This pattern illustrates how to determine if shelves have out of stock items using an Azure Stack Edge or Azure IoT Edge device and network cameras.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="7444f-105">Kontext och problem</span><span class="sxs-lookup"><span data-stu-id="7444f-105">Context and problem</span></span>

<span data-ttu-id="7444f-106">Fysiska butiker förlorar försäljning eftersom när kunderna letar efter ett objekt finns den inte på en hyllplan.</span><span class="sxs-lookup"><span data-stu-id="7444f-106">Physical retail stores lose sales because when customers look for an item, it's not present on the shelf.</span></span> <span data-ttu-id="7444f-107">Objektet kan dock ha funnits i butikens backend-lagring och inte fyllas på igen.</span><span class="sxs-lookup"><span data-stu-id="7444f-107">However, the item could have been in the back of the store and not been restocked.</span></span> <span data-ttu-id="7444f-108">Butiker vill använda personalen mer effektivt och meddelas automatiskt när objekt behöver fyllas på.</span><span class="sxs-lookup"><span data-stu-id="7444f-108">Stores would like to use their staff more efficiently and get automatically notified when items need restocking.</span></span>

## <a name="solution"></a><span data-ttu-id="7444f-109">Lösning</span><span class="sxs-lookup"><span data-stu-id="7444f-109">Solution</span></span>

<span data-ttu-id="7444f-110">I lösningsexempel används en gränsenhet, till exempel en Azure Stack Edge i varje butik, som effektivt bearbetar data från kameror i butiken.</span><span class="sxs-lookup"><span data-stu-id="7444f-110">The solution example uses an edge device, like an Azure Stack Edge in each store, which efficiently processes data from cameras in the store.</span></span> <span data-ttu-id="7444f-111">Med den här optimerade designen kan butiker endast skicka relevanta händelser och bilder till molnet.</span><span class="sxs-lookup"><span data-stu-id="7444f-111">This optimized design lets stores send only relevant events and images to the cloud.</span></span> <span data-ttu-id="7444f-112">Designen sparar bandbredd, lagringsutrymme och säkerställer kundens integritet.</span><span class="sxs-lookup"><span data-stu-id="7444f-112">The design saves bandwidth, storage space, and ensures customer privacy.</span></span> <span data-ttu-id="7444f-113">När bildrutor läses från varje kamera bearbetar en ML-modell bilden och returnerar alla områden utanför lagerområdet.</span><span class="sxs-lookup"><span data-stu-id="7444f-113">As frames are read from each camera, an ML model processes the image and returns any out of stock areas.</span></span> <span data-ttu-id="7444f-114">Bilden och utanför lagerområden visas i en lokal webbapp.</span><span class="sxs-lookup"><span data-stu-id="7444f-114">The image and out of stock areas are displayed on a local web app.</span></span> <span data-ttu-id="7444f-115">Dessa data kan skickas till en Time Series Insight-miljö för att visa insikter i Power BI.</span><span class="sxs-lookup"><span data-stu-id="7444f-115">This data can be sent to a Time Series Insight environment to show insights in Power BI.</span></span>

![Lösningsarkitektur med slut på lager vid gränsen](media/pattern-out-of-stock-at-edge/solution-architecture.png)

<span data-ttu-id="7444f-117">Så här fungerar lösningen:</span><span class="sxs-lookup"><span data-stu-id="7444f-117">Here's how the solution works:</span></span>

1. <span data-ttu-id="7444f-118">Bilder tas från en nätverkskamera via HTTP eller RTSP.</span><span class="sxs-lookup"><span data-stu-id="7444f-118">Images are captured from a network camera over HTTP or RTSP.</span></span>
2. <span data-ttu-id="7444f-119">Bildens storlek ändras och skickas till inferensdrivrutinen, som kommunicerar med ML-modellen för att avgöra om det finns några avbildningar som inte finns i lager.</span><span class="sxs-lookup"><span data-stu-id="7444f-119">The image is resized and sent to the inference driver, which communicates with the ML model to determine if there are any out of stock images.</span></span>
3. <span data-ttu-id="7444f-120">ML-modellen returnerar alla områden utanför lagerområdet.</span><span class="sxs-lookup"><span data-stu-id="7444f-120">The ML model returns any out of stock areas.</span></span>
4. <span data-ttu-id="7444f-121">Inferensdrivrutinen laddar upp den råa bilden till en blob (om sådan anges) och skickar resultatet från modellen till Azure IoT Hub och en begränsningsruta på enheten.</span><span class="sxs-lookup"><span data-stu-id="7444f-121">The inferencing driver uploads the raw image to a blob (if specified), and sends the results from the model to Azure IoT Hub and a bounding box processor on the device.</span></span>
5. <span data-ttu-id="7444f-122">Begränsningsreprocessorn lägger till avgränsande rutor i bilden och cachelagrar bildsökvägen i en minnes minnesbaserad databas.</span><span class="sxs-lookup"><span data-stu-id="7444f-122">The bounding box processor adds bounding boxes to the image and caches the image path in an in-memory database.</span></span>
6. <span data-ttu-id="7444f-123">Webbappen frågar efter bilder och visar dem i den ordning som tas emot.</span><span class="sxs-lookup"><span data-stu-id="7444f-123">The web app queries for images and shows them in the order received.</span></span>
7. <span data-ttu-id="7444f-124">Meddelanden från IoT Hub sammanställs i Time Series Insights.</span><span class="sxs-lookup"><span data-stu-id="7444f-124">Messages from IoT Hub are aggregated in Time Series Insights.</span></span>
8. <span data-ttu-id="7444f-125">Power BI visar en interaktiv rapport över slut på lagerartiklar över tid med data från Time Series Insights.</span><span class="sxs-lookup"><span data-stu-id="7444f-125">Power BI displays an interactive report of out of stock items over time with the data from Time Series Insights.</span></span>


## <a name="components"></a><span data-ttu-id="7444f-126">Komponenter</span><span class="sxs-lookup"><span data-stu-id="7444f-126">Components</span></span>

<span data-ttu-id="7444f-127">Den här lösningen använder följande komponenter:</span><span class="sxs-lookup"><span data-stu-id="7444f-127">This solution uses the following components:</span></span>

| <span data-ttu-id="7444f-128">Skikt</span><span class="sxs-lookup"><span data-stu-id="7444f-128">Layer</span></span> | <span data-ttu-id="7444f-129">Komponent</span><span class="sxs-lookup"><span data-stu-id="7444f-129">Component</span></span> | <span data-ttu-id="7444f-130">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="7444f-130">Description</span></span> |
|----------|-----------|-------------|
| <span data-ttu-id="7444f-131">Lokal maskinvara</span><span class="sxs-lookup"><span data-stu-id="7444f-131">On-premises hardware</span></span> | <span data-ttu-id="7444f-132">Nätverkskamera</span><span class="sxs-lookup"><span data-stu-id="7444f-132">Network camera</span></span> | <span data-ttu-id="7444f-133">En nätverkskamera krävs, med antingen en HTTP- eller RTSP-feed för att tillhandahålla bilder för slutsatsledning.</span><span class="sxs-lookup"><span data-stu-id="7444f-133">A network camera is required, with either an HTTP or RTSP feed to provide the images for inference.</span></span> |
| <span data-ttu-id="7444f-134">Azure</span><span class="sxs-lookup"><span data-stu-id="7444f-134">Azure</span></span> | <span data-ttu-id="7444f-135">Azure IoT Hub</span><span class="sxs-lookup"><span data-stu-id="7444f-135">Azure IoT Hub</span></span> | <span data-ttu-id="7444f-136">[Azure IoT Hub](/azure/iot-hub/) hanterar enhetsetablering och meddelanden för gränsenheterna.</span><span class="sxs-lookup"><span data-stu-id="7444f-136">[Azure IoT Hub](/azure/iot-hub/) handles device provisioning and messaging for the edge devices.</span></span> |
|  | <span data-ttu-id="7444f-137">Azure Time Series Insights</span><span class="sxs-lookup"><span data-stu-id="7444f-137">Azure Time Series Insights</span></span> | <span data-ttu-id="7444f-138">[Azure Time Series Insights](/azure/time-series-insights/) lagrar meddelanden från IoT Hub för visualisering.</span><span class="sxs-lookup"><span data-stu-id="7444f-138">[Azure Time Series Insights](/azure/time-series-insights/) stores the messages from IoT Hub for visualization.</span></span> |
|  | <span data-ttu-id="7444f-139">Power BI</span><span class="sxs-lookup"><span data-stu-id="7444f-139">Power BI</span></span> | <span data-ttu-id="7444f-140">[Microsoft Power BI](https://powerbi.microsoft.com/) tillhandahåller affärsfokuserade rapporter om händelser som inte är i lager.</span><span class="sxs-lookup"><span data-stu-id="7444f-140">[Microsoft Power BI](https://powerbi.microsoft.com/) provides business-focused reports of out of stock events.</span></span> <span data-ttu-id="7444f-141">Power BI ett lätt att använda instrumentpanelsgränssnitt för att visa utdata från Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="7444f-141">Power BI provides an easy-to-use dashboard interface for viewing the output from Azure Stream Analytics.</span></span> |
| <span data-ttu-id="7444f-142">Azure Stack Edge eller</span><span class="sxs-lookup"><span data-stu-id="7444f-142">Azure Stack Edge or</span></span><br><span data-ttu-id="7444f-143">Azure IoT Edge enhet</span><span class="sxs-lookup"><span data-stu-id="7444f-143">Azure IoT Edge device</span></span> | <span data-ttu-id="7444f-144">Azure IoT Edge</span><span class="sxs-lookup"><span data-stu-id="7444f-144">Azure IoT Edge</span></span> | <span data-ttu-id="7444f-145">[Azure IoT Edge](/azure/iot-edge/) orkestrering av körningen för de lokala containrarna och hanterar enhetshantering och uppdateringar.</span><span class="sxs-lookup"><span data-stu-id="7444f-145">[Azure IoT Edge](/azure/iot-edge/) orchestrates the runtime for the on-premises containers and handles device management and updates.</span></span>|
| | <span data-ttu-id="7444f-146">Brainwave för Azure-projekt</span><span class="sxs-lookup"><span data-stu-id="7444f-146">Azure project brainwave</span></span> | <span data-ttu-id="7444f-147">På en Azure Stack Edge enhet använder [Project Brainwave](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) Field-Programmable Gate Arrays (FPGA) för att påskynda ML-inferens.</span><span class="sxs-lookup"><span data-stu-id="7444f-147">On an Azure Stack Edge device, [Project Brainwave](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) uses Field-Programmable Gate Arrays (FPGAs) to accelerate ML inferencing.</span></span>|

## <a name="issues-and-considerations"></a><span data-ttu-id="7444f-148">Problem och överväganden</span><span class="sxs-lookup"><span data-stu-id="7444f-148">Issues and considerations</span></span>

<span data-ttu-id="7444f-149">Tänk på följande när du bestämmer hur du ska implementera den här lösningen:</span><span class="sxs-lookup"><span data-stu-id="7444f-149">Consider the following points when deciding how to implement this solution:</span></span>

### <a name="scalability"></a><span data-ttu-id="7444f-150">Skalbarhet</span><span class="sxs-lookup"><span data-stu-id="7444f-150">Scalability</span></span>

<span data-ttu-id="7444f-151">De flesta maskininlärningsmodeller kan bara köras på ett visst antal bildrutor per sekund, beroende på den maskinvara som tillhandahålls.</span><span class="sxs-lookup"><span data-stu-id="7444f-151">Most machine learning models can only run at a certain number of frames per second, depending on the provided hardware.</span></span> <span data-ttu-id="7444f-152">Fastställ den optimala samplingsfrekvensen från dina kamera(er) för att säkerställa att ML-pipelinen inte backar upp.</span><span class="sxs-lookup"><span data-stu-id="7444f-152">Determine the optimal sample rate from your camera(s) to ensure that the ML pipeline doesn't back up.</span></span> <span data-ttu-id="7444f-153">Olika typer av maskinvara hanterar olika antal kameror och bildfrekvenser.</span><span class="sxs-lookup"><span data-stu-id="7444f-153">Different types of hardware will handle different numbers of cameras and frame rates.</span></span>

### <a name="availability"></a><span data-ttu-id="7444f-154">Tillgänglighet</span><span class="sxs-lookup"><span data-stu-id="7444f-154">Availability</span></span>

<span data-ttu-id="7444f-155">Det är viktigt att tänka på vad som kan hända om gränsenheterna förlorar anslutningen.</span><span class="sxs-lookup"><span data-stu-id="7444f-155">It's important to consider what might happen if the edge device loses connectivity.</span></span> <span data-ttu-id="7444f-156">Fundera över vilka data som kan gå förlorade från Time Series Insights och Power BI instrumentpanel.</span><span class="sxs-lookup"><span data-stu-id="7444f-156">Consider what data might be lost from the Time Series Insights and Power BI dashboard.</span></span> <span data-ttu-id="7444f-157">Den tillhandahållna exempellösningen är inte utformad för att vara hög tillgänglig.</span><span class="sxs-lookup"><span data-stu-id="7444f-157">The example solution as provided isn't designed to be highly available.</span></span>

### <a name="manageability"></a><span data-ttu-id="7444f-158">Hanterbarhet</span><span class="sxs-lookup"><span data-stu-id="7444f-158">Manageability</span></span>

<span data-ttu-id="7444f-159">Den här lösningen kan sträcka sig över många enheter och platser, vilket kan bli oskadlig.</span><span class="sxs-lookup"><span data-stu-id="7444f-159">This solution can span many devices and locations, which could get unwieldy.</span></span> <span data-ttu-id="7444f-160">Azures IoT-tjänster kan automatiskt ta nya platser och enheter online och hålla dem uppdaterade.</span><span class="sxs-lookup"><span data-stu-id="7444f-160">Azure's IoT services can automatically bring new locations and devices online and keep them up to date.</span></span> <span data-ttu-id="7444f-161">Lämpliga procedurer för datastyrning måste också följas.</span><span class="sxs-lookup"><span data-stu-id="7444f-161">Proper data governance procedures must be followed as well.</span></span>

### <a name="security"></a><span data-ttu-id="7444f-162">Säkerhet</span><span class="sxs-lookup"><span data-stu-id="7444f-162">Security</span></span>

<span data-ttu-id="7444f-163">Det här mönstret hanterar potentiellt känsliga data.</span><span class="sxs-lookup"><span data-stu-id="7444f-163">This pattern handles potentially sensitive data.</span></span> <span data-ttu-id="7444f-164">Kontrollera att nycklarna roteras regelbundet och att behörigheterna för Azure Storage konto och lokala resurser har angetts korrekt.</span><span class="sxs-lookup"><span data-stu-id="7444f-164">Make sure keys are regularly rotated and the permissions on the Azure Storage Account and local shares are correctly set.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7444f-165">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="7444f-165">Next steps</span></span>

<span data-ttu-id="7444f-166">Mer information om ämnen som introduceras i den här artikeln:</span><span class="sxs-lookup"><span data-stu-id="7444f-166">To learn more about topics introduced in this article:</span></span>
- <span data-ttu-id="7444f-167">Flera IoT-relaterade tjänster används i det här [mönstret, inklusive Azure IoT Edge](/azure/iot-edge/), [Azure IoT Hub](/azure/iot-hub/)och [Azure Time Series Insights](/azure/time-series-insights/).</span><span class="sxs-lookup"><span data-stu-id="7444f-167">Multiple IoT related services are used in this pattern, including [Azure IoT Edge](/azure/iot-edge/), [Azure IoT Hub](/azure/iot-hub/), and [Azure Time Series Insights](/azure/time-series-insights/).</span></span>
- <span data-ttu-id="7444f-168">Mer information om Microsoft Project [](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) Brainwave finns i bloggmeddelandet och kolla in [videon Azure Accelerated Machine Learning with Project Brainwave (Azure Accelerated Machine Learning with Project Brainwave).](https://www.youtube.com/watch?v=DJfMobMjCX0)</span><span class="sxs-lookup"><span data-stu-id="7444f-168">To learn more about Microsoft Project Brainwave, see [the blog announcement](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) and checkout out the [Azure Accelerated Machine Learning with Project Brainwave video](https://www.youtube.com/watch?v=DJfMobMjCX0).</span></span>
- <span data-ttu-id="7444f-169">Se [Designöverväganden för hybridapp](overview-app-design-considerations.md) för att lära dig mer om metodtips och få svar på eventuella ytterligare frågor.</span><span class="sxs-lookup"><span data-stu-id="7444f-169">See [Hybrid app design considerations](overview-app-design-considerations.md) to learn more about best practices and to get answers to any additional questions.</span></span>
- <span data-ttu-id="7444f-170">I Azure Stack [med produkter och lösningar kan du](/azure-stack) läsa mer om hela portföljen med produkter och lösningar.</span><span class="sxs-lookup"><span data-stu-id="7444f-170">See the [Azure Stack family of products and solutions](/azure-stack) to learn more about the entire portfolio of products and solutions.</span></span>

<span data-ttu-id="7444f-171">När du är redo att testa lösningsexempel fortsätter du med distributionsguiden [för Edge ML-härledningslösningen.](https://aka.ms/edgeinferencingdeploy)</span><span class="sxs-lookup"><span data-stu-id="7444f-171">When you're ready to test the solution example, continue with the [Edge ML inferencing solution deployment guide](https://aka.ms/edgeinferencingdeploy).</span></span> <span data-ttu-id="7444f-172">Distributionsguiden innehåller stegvisa instruktioner för att distribuera och testa dess komponenter.</span><span class="sxs-lookup"><span data-stu-id="7444f-172">The deployment guide provides step-by-step instructions for deploying and testing its components.</span></span>
