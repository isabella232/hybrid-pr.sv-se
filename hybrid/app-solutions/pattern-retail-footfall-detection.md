---
title: Footfall identifierings mönster med Azure och Azure Stack hubb
description: Lär dig hur du använder Azure och Azure Stack Hub för att implementera en AI-baserad lösning för identifiering av Footfall för analys av detalj handels lagrings trafik.
author: BryanLa
ms.topic: article
ms.date: 10/31/2019
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 10/31/2019
ms.openlocfilehash: 866557ec3af2337e9f034da84cf417675508563b
ms.sourcegitcommit: 962334135b63ac99c715e7bc8fb9282648ba63c9
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 03/23/2021
ms.locfileid: "104895337"
---
# <a name="footfall-detection-pattern"></a><span data-ttu-id="3c5b3-103">Mönster för Footfall-identifiering</span><span class="sxs-lookup"><span data-stu-id="3c5b3-103">Footfall detection pattern</span></span>

<span data-ttu-id="3c5b3-104">Det här mönstret ger en översikt över hur du implementerar en AI-baserad lösning för identifiering av Footfall för att analysera besökares trafik i butiker.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-104">This pattern provides an overview for implementing an AI-based footfall detection solution for analyzing visitor traffic in retail stores.</span></span> <span data-ttu-id="3c5b3-105">Lösningen genererar insikter från verkliga åtgärder med hjälp av Azure, Azure Stack Hub och Custom Vision AI dev kit.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-105">The solution generates insights from real world actions, using Azure, Azure Stack Hub, and the Custom Vision AI Dev Kit.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="3c5b3-106">Kontext och problem</span><span class="sxs-lookup"><span data-stu-id="3c5b3-106">Context and problem</span></span>

<span data-ttu-id="3c5b3-107">Contoso-butiker vill få insikter om hur kunderna får sina aktuella produkter i förhållande till Store-layout.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-107">Contoso Stores would like to gain insights on how customers are receiving their current products in relation to store layout.</span></span> <span data-ttu-id="3c5b3-108">De kan inte placera personal i varje avsnitt och det är ineffektivt att ha ett team med analytiker granska en hel butiks kamera tagningar.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-108">They're unable to place staff in every section and it's inefficient to have a team of analysts review an entire store's camera footage.</span></span> <span data-ttu-id="3c5b3-109">Dessutom har ingen av sina butiker tillräckligt med bandbredd för att strömma video från alla kameror till molnet för analys.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-109">In addition, none of their stores have enough bandwidth to stream video from all their cameras to the cloud for analysis.</span></span>

<span data-ttu-id="3c5b3-110">Contoso vill kunna hitta ett diskret, sekretess sätt för att fastställa deras kunders demografiska uppgifter, lojalitet och reaktioner på att lagra skärmar och produkter.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-110">Contoso would like to find an unobtrusive, privacy-friendly way to determine their customers' demographics, loyalty, and reactions to store displays and products.</span></span>

## <a name="solution"></a><span data-ttu-id="3c5b3-111">Lösning</span><span class="sxs-lookup"><span data-stu-id="3c5b3-111">Solution</span></span>

<span data-ttu-id="3c5b3-112">Det här mönstret för detalj handels analys använder en metod med flera nivåer för inferencing i kanten.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-112">This retail analytics pattern uses a tiered approach to inferencing at the edge.</span></span> <span data-ttu-id="3c5b3-113">Genom att använda Custom Vision AI dev kit skickas bara bilder med mänskliga ansikten för analys till ett privat Azure Stack hubb som kör Azure Cognitive Services.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-113">By using the Custom Vision AI Dev Kit, only images with human faces are sent for analysis to a private Azure Stack Hub that runs Azure Cognitive Services.</span></span> <span data-ttu-id="3c5b3-114">Anonymiserats skickas sammanställda data till Azure för agg regering över alla butiker och visualiseringar i Power BI.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-114">Anonymized, aggregated data is sent to Azure for aggregation across all stores and visualization in Power BI.</span></span> <span data-ttu-id="3c5b3-115">Genom att kombinera Edge och det offentliga molnet kan Contoso dra nytta av modern AI-teknik samtidigt som de fortfarande är kompatibla med företagets principer och respektera sina kunders integritet.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-115">Combining the edge and public cloud lets Contoso take advantage of modern AI technology while also remaining in compliance with their corporate policies and respecting their customers' privacy.</span></span>

<span data-ttu-id="3c5b3-116">[![Lösning för Footfall identifierings mönster](media/pattern-retail-footfall-detection/solution-architecture.png)](media/pattern-retail-footfall-detection/solution-architecture.png)</span><span class="sxs-lookup"><span data-stu-id="3c5b3-116">[![Footfall detection pattern solution](media/pattern-retail-footfall-detection/solution-architecture.png)](media/pattern-retail-footfall-detection/solution-architecture.png)</span></span>

<span data-ttu-id="3c5b3-117">Här är en sammanfattning av hur lösningen fungerar:</span><span class="sxs-lookup"><span data-stu-id="3c5b3-117">Here's a summary of how the solution works:</span></span>

1. <span data-ttu-id="3c5b3-118">Custom Vision AI dev kit hämtar en konfiguration från IoT Hub, som installerar IoT Edge Runtime och en ML-modell.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-118">The Custom Vision AI Dev Kit gets a configuration from IoT Hub, which installs the IoT Edge Runtime and an ML model.</span></span>
2. <span data-ttu-id="3c5b3-119">Om modellen ser en person, tar den en bild och laddar upp den till Azure Stack hubb Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-119">If the model sees a person, it takes a picture and uploads it to Azure Stack Hub blob storage.</span></span>
3. <span data-ttu-id="3c5b3-120">Blob-tjänsten utlöser en Azure-funktion på Azure Stack Hub.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-120">The blob service triggers an Azure Function on Azure Stack Hub.</span></span>
4. <span data-ttu-id="3c5b3-121">Azure-funktionen anropar en behållare med Ansikts-API för att få demografisk och känslo data från avbildningen.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-121">The Azure Function calls a container with the Face API to get demographic and emotion data from the image.</span></span>
5. <span data-ttu-id="3c5b3-122">Data är anonymiserats och skickas till ett Azure Event Hubs-kluster.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-122">The data is anonymized and sent to an Azure Event Hubs cluster.</span></span>
6. <span data-ttu-id="3c5b3-123">Event Hubs klustret pushar bort data till Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-123">The Event Hubs cluster pushes the data to Stream Analytics.</span></span>
7. <span data-ttu-id="3c5b3-124">Stream Analytics samlar in data och skickar dem till Power BI.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-124">Stream Analytics aggregates the data and pushes it to Power BI.</span></span>

## <a name="components"></a><span data-ttu-id="3c5b3-125">Komponenter</span><span class="sxs-lookup"><span data-stu-id="3c5b3-125">Components</span></span>

<span data-ttu-id="3c5b3-126">Den här lösningen använder följande komponenter:</span><span class="sxs-lookup"><span data-stu-id="3c5b3-126">This solution uses the following components:</span></span>

| <span data-ttu-id="3c5b3-127">Skikt</span><span class="sxs-lookup"><span data-stu-id="3c5b3-127">Layer</span></span> | <span data-ttu-id="3c5b3-128">Komponent</span><span class="sxs-lookup"><span data-stu-id="3c5b3-128">Component</span></span> | <span data-ttu-id="3c5b3-129">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="3c5b3-129">Description</span></span> |
|----------|-----------|-------------|
| <span data-ttu-id="3c5b3-130">Maskin vara i butiken</span><span class="sxs-lookup"><span data-stu-id="3c5b3-130">In-store hardware</span></span> | [<span data-ttu-id="3c5b3-131">Custom Vision AI dev kit</span><span class="sxs-lookup"><span data-stu-id="3c5b3-131">Custom Vision AI Dev Kit</span></span>](https://azure.github.io/Vision-AI-DevKit-Pages/) | <span data-ttu-id="3c5b3-132">Tillhandahåller filtrering i butiken med hjälp av en lokal ML-modell som bara fångar bilder av personer för analys.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-132">Provides in-store filtering using a local ML model that only captures images of people for analysis.</span></span> <span data-ttu-id="3c5b3-133">Säkert etablerade och uppdaterade via IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-133">Securely provisioned and updated through IoT Hub.</span></span><br><br>|
| <span data-ttu-id="3c5b3-134">Azure</span><span class="sxs-lookup"><span data-stu-id="3c5b3-134">Azure</span></span> | [<span data-ttu-id="3c5b3-135">Azure Event Hubs</span><span class="sxs-lookup"><span data-stu-id="3c5b3-135">Azure Event Hubs</span></span>](/azure/event-hubs/) | <span data-ttu-id="3c5b3-136">Azure Event Hubs ger en skalbar plattform för att mata in anonymiserats-data som kan integreras snyggt med Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-136">Azure Event Hubs provides a scalable platform for ingesting anonymized data that integrates neatly with Azure Stream Analytics.</span></span> |
|  | [<span data-ttu-id="3c5b3-137">Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="3c5b3-137">Azure Stream Analytics</span></span>](/azure/stream-analytics/) | <span data-ttu-id="3c5b3-138">Ett Azure Stream Analytics jobb sammanställer anonymiserats-data och grupperar dem till 15-sekunders fönster för visualisering.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-138">An Azure Stream Analytics job aggregates the anonymized data and groups it into 15-second windows for visualization.</span></span> |
|  | [<span data-ttu-id="3c5b3-139">Microsoft Power BI</span><span class="sxs-lookup"><span data-stu-id="3c5b3-139">Microsoft Power BI</span></span>](https://powerbi.microsoft.com/) | <span data-ttu-id="3c5b3-140">Power BI tillhandahåller ett lättanvänt instrument panels gränssnitt för visning av utdata från Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-140">Power BI provides an easy-to-use dashboard interface for viewing the output from Azure Stream Analytics.</span></span> |
| <span data-ttu-id="3c5b3-141">Azure Stack Hub</span><span class="sxs-lookup"><span data-stu-id="3c5b3-141">Azure Stack Hub</span></span> | [<span data-ttu-id="3c5b3-142">App Service</span><span class="sxs-lookup"><span data-stu-id="3c5b3-142">App Service</span></span>](/azure-stack/operator/azure-stack-app-service-overview) | <span data-ttu-id="3c5b3-143">App Service Resource Provider (RP) tillhandahåller en bas för Edge-komponenter, inklusive värd-och hanterings funktioner för webbappar/API: er och funktioner.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-143">The App Service resource provider (RP) provides a base for edge components, including hosting and management features for web apps/APIs and Functions.</span></span> |
| | <span data-ttu-id="3c5b3-144">Azure Kubernetes service [(AKS)-motor](https://github.com/Azure/aks-engine) kluster</span><span class="sxs-lookup"><span data-stu-id="3c5b3-144">Azure Kubernetes Service [(AKS) Engine](https://github.com/Azure/aks-engine) cluster</span></span> | <span data-ttu-id="3c5b3-145">AKS RP med AKS-Engine-kluster som distribuerats till Azure Stack Hub ger en skalbar, elastisk motor för att köra Ansikts-API containern.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-145">The AKS RP with AKS-Engine cluster deployed into Azure Stack Hub provides a scalable, resilient engine to run the Face API container.</span></span> |
| | <span data-ttu-id="3c5b3-146">[Ansikts-API behållare](/azure/cognitive-services/face/face-how-to-install-containers) för Azure Cognitive Services</span><span class="sxs-lookup"><span data-stu-id="3c5b3-146">Azure Cognitive Services [Face API containers](/azure/cognitive-services/face/face-how-to-install-containers)</span></span>| <span data-ttu-id="3c5b3-147">Azure Cognitive Services RP med Ansikts-API-behållare tillhandahåller demografisk, känslo och unik identifiering av besökare i Contosos privata nätverk.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-147">The Azure Cognitive Services RP with Face API containers provides demographic, emotion, and unique visitor detection on Contoso's private network.</span></span> |
| | <span data-ttu-id="3c5b3-148">Blob Storage</span><span class="sxs-lookup"><span data-stu-id="3c5b3-148">Blob Storage</span></span> | <span data-ttu-id="3c5b3-149">Bilder som har hämtats från AI dev kit överförs till Azure Stack hubbens Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-149">Images captured from the AI Dev Kit are uploaded to Azure Stack Hub's blob storage.</span></span> |
| | <span data-ttu-id="3c5b3-150">Azure Functions</span><span class="sxs-lookup"><span data-stu-id="3c5b3-150">Azure Functions</span></span> | <span data-ttu-id="3c5b3-151">En Azure-funktion som körs på Azure Stack hub tar emot indata från Blob Storage och hanterar interaktioner med Ansikts-API.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-151">An Azure Function running on Azure Stack Hub receives input from blob storage and manages the interactions with the Face API.</span></span> <span data-ttu-id="3c5b3-152">Den avger anonymiserats-data till ett Event Hubs-kluster som finns i Azure.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-152">It emits anonymized data to an Event Hubs cluster located in Azure.</span></span><br><br>|

## <a name="issues-and-considerations"></a><span data-ttu-id="3c5b3-153">Problem och överväganden</span><span class="sxs-lookup"><span data-stu-id="3c5b3-153">Issues and considerations</span></span>

<span data-ttu-id="3c5b3-154">Tänk på följande när du bestämmer hur du ska implementera den här lösningen:</span><span class="sxs-lookup"><span data-stu-id="3c5b3-154">Consider the following points when deciding how to implement this solution:</span></span>

### <a name="scalability"></a><span data-ttu-id="3c5b3-155">Skalbarhet</span><span class="sxs-lookup"><span data-stu-id="3c5b3-155">Scalability</span></span>

<span data-ttu-id="3c5b3-156">För att den här lösningen ska kunna skalas över flera kameror och platser måste du kontrol lera att alla komponenter kan hantera den ökade belastningen.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-156">To enable this solution to scale across multiple cameras and locations, you'll need to make sure that all of the components can handle the increased load.</span></span> <span data-ttu-id="3c5b3-157">Du kan behöva vidta åtgärder som:</span><span class="sxs-lookup"><span data-stu-id="3c5b3-157">You may need to take actions like:</span></span>

- <span data-ttu-id="3c5b3-158">Öka antalet Stream Analytics strömnings enheter.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-158">Increase the number of Stream Analytics streaming units.</span></span>
- <span data-ttu-id="3c5b3-159">Skala ut Ansikts-API-distributionen.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-159">Scale out the Face API deployment.</span></span>
- <span data-ttu-id="3c5b3-160">Öka Event Hubs-klustrets data flöde.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-160">Increase the Event Hubs cluster throughput.</span></span>
- <span data-ttu-id="3c5b3-161">För extrema fall kan det vara nödvändigt att migrera från Azure Functions till en virtuell dator.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-161">For extreme cases, migrate from Azure Functions to a virtual machine may be necessary.</span></span>

### <a name="availability"></a><span data-ttu-id="3c5b3-162">Tillgänglighet</span><span class="sxs-lookup"><span data-stu-id="3c5b3-162">Availability</span></span>

<span data-ttu-id="3c5b3-163">Eftersom den här lösningen är i nivå av, är det viktigt att tänka på hur du hanterar nätverk eller strömavbrott.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-163">Since this solution is tiered, it's important to think about how to deal with networking or power failures.</span></span> <span data-ttu-id="3c5b3-164">Beroende på affärs behov kanske du vill implementera en mekanism för att cachelagra avbildningar lokalt och sedan vidarebefordra till Azure Stack hubb när anslutningen returnerar.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-164">Depending on business needs, you might want to implement a mechanism to cache images locally, then forward to Azure Stack Hub when connectivity returns.</span></span> <span data-ttu-id="3c5b3-165">Om platsen är tillräckligt stor kan det vara ett bättre alternativ att distribuera en Data Box Edge med Ansikts-API container till den platsen.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-165">If the location is large enough, deploying a Data Box Edge with the Face API container to that location might be a better option.</span></span>

### <a name="manageability"></a><span data-ttu-id="3c5b3-166">Hanterbarhet</span><span class="sxs-lookup"><span data-stu-id="3c5b3-166">Manageability</span></span>

<span data-ttu-id="3c5b3-167">Den här lösningen kan omfatta många enheter och platser, vilket kan ge svårhanterligt.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-167">This solution can span many devices and locations, which could get unwieldy.</span></span> <span data-ttu-id="3c5b3-168">[Azures IoT-tjänster](/azure/iot-fundamentals/) kan användas för att automatiskt ta nya platser och enheter online och hålla dem uppdaterade.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-168">[Azure's IoT services](/azure/iot-fundamentals/) can be used to automatically bring new locations and devices online and keep them up to date.</span></span>

### <a name="security"></a><span data-ttu-id="3c5b3-169">Säkerhet</span><span class="sxs-lookup"><span data-stu-id="3c5b3-169">Security</span></span>

<span data-ttu-id="3c5b3-170">Den här lösningen fångar kund avbildningar, vilket gör säkerheten till en avgörande faktor.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-170">This solution captures customer images, making security a paramount consideration.</span></span> <span data-ttu-id="3c5b3-171">Kontrol lera att alla lagrings konton skyddas med rätt åtkomst principer och rotera nycklar regelbundet.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-171">Make sure all storage accounts are secured with the proper access policies and rotate keys regularly.</span></span> <span data-ttu-id="3c5b3-172">Se till att lagrings konton och Event Hubs har bevarande principer som uppfyller sekretess bestämmelser för företag och myndigheter.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-172">Ensure storage accounts and Event Hubs have retention policies that meet corporate and government privacy regulations.</span></span> <span data-ttu-id="3c5b3-173">Se också till att nivå nivåer för användar åtkomst.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-173">Also make sure to tier the user access levels.</span></span> <span data-ttu-id="3c5b3-174">Med skiktning ser du till att användarna bara har åtkomst till de data de behöver för sin roll.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-174">Tiering ensures that users only have access to the data they need for their role.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3c5b3-175">Nästa steg</span><span class="sxs-lookup"><span data-stu-id="3c5b3-175">Next steps</span></span>

<span data-ttu-id="3c5b3-176">Mer information om de ämnen som introduceras i den här artikeln:</span><span class="sxs-lookup"><span data-stu-id="3c5b3-176">To learn more about the topics introduced in this article:</span></span>

- <span data-ttu-id="3c5b3-177">Se det [skiktade data mönstret](https://aka.ms/tiereddatadeploy), som utnyttjas av Footfall identifierings mönster.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-177">See the [Tiered Data pattern](https://aka.ms/tiereddatadeploy), which is leveraged by the footfall detection pattern.</span></span>
- <span data-ttu-id="3c5b3-178">Läs mer om hur du använder anpassad vision i [Custom vision AI dev kit](https://azure.github.io/Vision-AI-DevKit-Pages/) .</span><span class="sxs-lookup"><span data-stu-id="3c5b3-178">See the [Custom Vision AI Dev Kit](https://azure.github.io/Vision-AI-DevKit-Pages/) to learn more about using custom vision.</span></span> 

<span data-ttu-id="3c5b3-179">När du är redo att testa lösnings exemplet fortsätter du med [distributions guiden för Footfall-identifiering](solution-deployment-guide-retail-footfall-detection.md).</span><span class="sxs-lookup"><span data-stu-id="3c5b3-179">When you're ready to test the solution example, continue with the [Footfall detection deployment guide](solution-deployment-guide-retail-footfall-detection.md).</span></span> <span data-ttu-id="3c5b3-180">Distributions guiden innehåller steg-för-steg-instruktioner för att distribuera och testa dess komponenter.</span><span class="sxs-lookup"><span data-stu-id="3c5b3-180">The deployment guide provides step-by-step instructions for deploying and testing its components.</span></span>
